
/* /website/static/src/js/editor/editor.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.editor',function(require){'use strict';var weWidgets=require('web_editor.widget');var wUtils=require('website.utils');weWidgets.LinkDialog.include({start:function(){wUtils.autocompleteWithPages(this,this.$('input[name="url"]'));return this._super.apply(this,arguments);},});});;

/* /website/static/src/js/editor/rte.summernote.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.rte.summernote',function(require){'use strict';var core=require('web.core');require('web_editor.rte.summernote');var eventHandler=$.summernote.eventHandler;var renderer=$.summernote.renderer;var tplIconButton=renderer.getTemplate().iconButton;var _t=core._t;var fn_tplPopovers=renderer.tplPopovers;renderer.tplPopovers=function(lang,options){var $popover=$(fn_tplPopovers.call(this,lang,options));$popover.find('.note-image-popover .btn-group:has([data-value="img-thumbnail"])').append(tplIconButton('fa fa-object-ungroup',{title:_t('Transform the picture (click twice to reset transformation)'),event:'transform',}));return $popover;};$.summernote.pluginEvents.transform=function(event,editor,layoutInfo,sorted){var $selection=layoutInfo.handle().find('.note-control-selection');var $image=$($selection.data('target'));if($image.data('transfo-destroy')){$image.removeData('transfo-destroy');return;}
$image.transfo();var mouseup=function(event){$('.note-popover button[data-event="transform"]').toggleClass('active',$image.is('[style*="transform"]'));};$(document).on('mouseup',mouseup);var mousedown=function(event){if(!$(event.target).closest('.transfo-container').length){$image.transfo('destroy');$(document).off('mousedown',mousedown).off('mouseup',mouseup);}
if($(event.target).closest('.note-popover').length){$image.data('transfo-destroy',true).attr('style',($image.attr('style')||'').replace(/[^;]*transform[\w:]*;?/g,''));}
$image.trigger('content_changed');};$(document).on('mousedown',mousedown);};var fn_boutton_update=eventHandler.modules.popover.button.update;eventHandler.modules.popover.button.update=function($container,oStyle){fn_boutton_update.call(this,$container,oStyle);$container.find('button[data-event="transform"]').toggleClass('active',$(oStyle.image).is('[style*="transform"]')).toggleClass('d-none',!$(oStyle.image).is('img'));};});;

/* /website/static/src/js/editor/snippets.options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.editor.snippets.options',function(require){'use strict';var core=require('web.core');var Dialog=require('web.Dialog');var weWidgets=require('wysiwyg.widgets');var options=require('web_editor.snippets.options');var _t=core._t;var qweb=core.qweb;options.Class.include({_refreshPublicWidgets:function($el){this.trigger_up('widgets_start_request',{editableMode:true,$target:$el||this.$target,});},});options.registry.background.include({_getEditableMedia:function(){if(!this._hasBgvideo()){return this._super(...arguments);}
return this.$('.o_bg_video_iframe')[0];},_getMediaDialogOptions:function(){return _.extend(this._super(...arguments),{noVideos:this.$target.is('.parallax, .s_parallax_bg'),isForBgVideo:true,});},_setActive:function(){this._super(...arguments);if(this._hasBgvideo()){this.$el.find('[data-choose-image]').addClass('active');}},_setBgVideo:function(previewMode,value){this.$('> .o_bg_video_container').toggleClass('d-none',previewMode===true);if(previewMode!==false){return;}
var target=this.$target[0];target.classList.toggle('o_background_video',!!(value&&value.length));if(value&&value.length){target.dataset.bgVideoSrc=value;}else{delete target.dataset.bgVideoSrc;}
this._refreshPublicWidgets();this._setActive();},_hasBgvideo:function(){return this.$target[0].classList.contains('o_background_video');},_onBackgroundColorUpdate:function(ev,previewMode){var ret=this._super(...arguments);if(ret){this._setBgVideo(previewMode);}
return ret;},_onSaveMediaDialog:function(data){if(!data.bgVideoSrc){this._setBgVideo(false);this._super(...arguments);return;}
this._setBgVideo(false,data.bgVideoSrc);},});options.registry.menu_data=options.Class.extend({xmlDependencies:['/website/static/src/xml/website.editor.xml'],onFocus:function(){var self=this;(new Dialog(this,{title:_t("Confirmation"),$content:$(core.qweb.render('website.leaving_current_page_edition')),buttons:[{text:_t("Go to Link"),classes:'btn-primary',click:function(){self.trigger_up('request_save',{reload:false,onSuccess:function(){window.location.href=self.$target.attr('href');},});}},{text:_t("Edit the menu"),classes:'btn-primary',click:function(){this.trigger_up('action_demand',{actionName:'edit_menu',params:[function(){var prom=new Promise(function(resolve,reject){self.trigger_up('request_save',{onSuccess:resolve,onFailure:reject,});});return prom;},],});}},{text:_t("Stay on this page"),close:true}]})).open();},});options.registry.company_data=options.Class.extend({start:function(){var proto=options.registry.company_data.prototype;var prom;var self=this;if(proto.__link===undefined){prom=this._rpc({route:'/web/session/get_session_info'}).then(function(session){return self._rpc({model:'res.users',method:'read',args:[session.uid,['company_id']],});}).then(function(res){proto.__link='/web#action=base.action_res_company_form&view_type=form&id='+(res&&res[0]&&res[0].company_id[0]||1);});}
return Promise.all([this._super.apply(this,arguments),prom]);},onFocus:function(){var self=this;var proto=options.registry.company_data.prototype;Dialog.confirm(this,_t("Do you want to edit the company data ?"),{confirm_callback:function(){self.trigger_up('request_save',{reload:false,onSuccess:function(){window.location.href=proto.__link;},});},});},});options.registry.carousel=options.Class.extend({start:function(){var self=this;this.$target.carousel({interval:false});this.id=this.$target.attr('id');this.$inner=this.$target.find('.carousel-inner');this.$indicators=this.$target.find('.carousel-indicators');this.$target.carousel('pause');this._rebindEvents();var def=this._super.apply(this,arguments);this.$target.on('slid.bs.carousel',function(){self.$target.carousel('pause');self.trigger_up('option_update',{optionNames:['background','background_position','colorpicker','sizing_y'],name:'target',data:self.$target.find('.carousel-item.active'),});});return def;},onBuilt:function(){this.id='myCarousel'+new Date().getTime();this.$target.attr('id',this.id);this.$target.find('[data-target]').attr('data-target','#'+this.id);this._rebindEvents();},onFocus:function(){this.$target.trigger('slid.bs.carousel');},onClone:function(){var id='myCarousel'+new Date().getTime();this.$target.attr('id',id);this.$target.find('[data-slide]').attr('href','#'+id);this.$target.find('[data-slide-to]').attr('data-target','#'+id);},cleanForSave:function(){this._super.apply(this,arguments);this.$target.find('.carousel-item').removeClass('next prev left right active').first().addClass('active');this.$target.find('.carousel-indicators').find('li').removeClass('active').html('').first().addClass('active');this.$target.removeClass('oe_img_bg '+this._class).css('background-image','');},addSlide:function(previewMode){var self=this;var cycle=this.$inner.find('.carousel-item').length;var $active=this.$inner.find('.carousel-item.active, .carousel-item.prev, .carousel-item.next').first();var index=$active.index();this.$('.carousel-control-prev, .carousel-control-next, .carousel-indicators').removeClass('d-none');this.$indicators.append('<li data-target="#'+this.id+'" data-slide-to="'+cycle+'"></li>');var $clone=$active.clone(true);$clone.removeClass('active').insertAfter($active);_.defer(function(){self.$target.carousel().carousel(++index);self._rebindEvents();});},removeSlide:function(previewMode){if(this.remove_process){return;}
var self=this;var $items=this.$inner.find('.carousel-item');var cycle=$items.length-1;var $active=$items.filter('.active');var index=$active.index();if(cycle>0){this.remove_process=true;this.$target.on('slid.bs.carousel.slide_removal',function(event){$active.remove();self.$indicators.find('li:last').remove();self.$target.off('slid.bs.carousel.slide_removal');self._rebindEvents();self.remove_process=false;if(cycle===1){self.$target.find('.carousel-control-prev, .carousel-control-next, .carousel-indicators').addClass('d-none');}});_.defer(function(){self._refreshPublicWidgets();self.$target.carousel(index>0?--index:cycle);});}},interval:function(previewMode,value){this.$target.attr('data-interval',value);},_setActive:function(){this._super.apply(this,arguments);this.$el.find('[data-interval]').removeClass('active').filter('[data-interval='+this.$target.attr('data-interval')+']').addClass('active');},_rebindEvents:function(){var self=this;this.$target.find('.carousel-control-prev, .carousel-control-next').off('click').on('click',function(){self.$target.carousel($(this).data('slide'));});this.$target.find('.carousel-indicators [data-slide-to]').off('click').on('click',function(){self.$target.carousel(+$(this).data('slide-to'));});this.$target.find('.item.text_image, .item.image_text, .item.text_only').find('.container > .carousel-caption > div, .container > img.carousel-image').attr('contentEditable','true');},});options.registry.navTabs=options.Class.extend({start:function(){this._findLinksAndPanes();return this._super.apply(this,arguments);},onBuilt:function(){this._generateUniqueIDs();},onClone:function(){this._generateUniqueIDs();},addTab:function(previewMode,value,$opt){var $activeItem=this.$navLinks.filter('.active').parent();var $activePane=this.$tabPanes.filter('.active');var $navItem=$activeItem.clone();var $navLink=$navItem.find('.nav-link').removeClass('active show');var $tabPane=$activePane.clone().removeClass('active show');$navItem.insertAfter($activeItem);$tabPane.insertAfter($activePane);this._findLinksAndPanes();this._generateUniqueIDs();$navLink.tab('show');},removeTab:function(previewMode,value,$opt){var self=this;var $activeLink=this.$navLinks.filter('.active');var $activePane=this.$tabPanes.filter('.active');var $next=this.$navLinks.eq((this.$navLinks.index($activeLink)+1)%this.$navLinks.length);$next.one('shown.bs.tab',function(){$activeLink.parent().remove();$activePane.remove();self._findLinksAndPanes();self._setActive();});$next.tab('show');},_findLinksAndPanes:function(){this.$navLinks=this.$target.find('.nav-link');var $el=this.$target;do{$el=$el.parent();this.$tabPanes=$el.find('.tab-pane');}while(this.$tabPanes.length===0&&!$el.is('body'));},_generateUniqueIDs:function(){for(var i=0;i<this.$navLinks.length;i++){var id=_.now()+'_'+_.uniqueId();var idLink='nav_tabs_link_'+id;var idContent='nav_tabs_content_'+id;this.$navLinks.eq(i).attr({'id':idLink,'href':'#'+idContent,'aria-controls':idContent,});this.$tabPanes.eq(i).attr({'id':idContent,'aria-labelledby':idLink,});}},_setActive:function(){this._super.apply(this,arguments);this.$el.filter('[data-remove-tab]').toggleClass('d-none',this.$tabPanes.length<=2);},});options.registry.sizing_x=options.registry.sizing.extend({onClone:function(options){this._super.apply(this,arguments);if(options.isCurrent){var _class=this.$target.attr('class').replace(/\s*(offset-xl-|offset-lg-)([0-9-]+)/g,'');this.$target.attr('class',_class);}},_getSize:function(){var width=this.$target.closest('.row').width();var gridE=[1,2,3,4,5,6,7,8,9,10,11,12];var gridW=[0,1,2,3,4,5,6,7,8,9,10,11];this.grid={e:[_.map(gridE,function(v){return'col-lg-'+v;}),_.map(gridE,function(v){return width/12*v;}),'width'],w:[_.map(gridW,function(v){return'offset-lg-'+v;}),_.map(gridW,function(v){return width/12*v;}),'margin-left'],};return this.grid;},_onResize:function(compass,beginClass,current){if(compass==='w'){var beginCol=Number(beginClass.match(/col-lg-([0-9]+)|$/)[1]||0);var beginOffset=Number(beginClass.match(/offset-lg-([0-9-]+)|$/)[1]||beginClass.match(/offset-xl-([0-9-]+)|$/)[1]||0);var offset=Number(this.grid.w[0][current].match(/offset-lg-([0-9-]+)|$/)[1]||0);if(offset<0){offset=0;}
var colSize=beginCol-(offset-beginOffset);if(colSize<=0){colSize=1;offset=beginOffset+beginCol-1;}
this.$target.attr('class',this.$target.attr('class').replace(/\s*(offset-xl-|offset-lg-|col-lg-)([0-9-]+)/g,''));this.$target.addClass('col-lg-'+(colSize>12?12:colSize));if(offset>0){this.$target.addClass('offset-lg-'+offset);}}
this._super.apply(this,arguments);},});options.registry.layout_column=options.Class.extend({selectCount:function(previewMode,value,$opt){this._updateColumnCount(value-this.$target.children().length);},_updateColumnCount:function(count){if(!count){return;}
this.trigger_up('request_history_undo_record',{$target:this.$target});if(count>0){var $lastColumn=this.$target.children().last();for(var i=0;i<count;i++){this.trigger_up('clone_snippet',{$snippet:$lastColumn});}}else{var self=this;_.each(this.$target.children().slice(count),function(el){self.trigger_up('remove_snippet',{$snippet:$(el)});});}
this._resizeColumns();this.trigger_up('cover_update');},_resizeColumns:function(){var $columns=this.$target.children();var colsLength=$columns.length;var colSize=Math.floor(12/colsLength)||1;var colOffset=Math.floor((12-colSize*colsLength)/2);var colClass='col-lg-'+colSize;_.each($columns,function(column){var $column=$(column);$column.attr('class',$column.attr('class').replace(/\b(col|offset)-lg(-\d+)?\b/g,''));$column.addClass(colClass);});if(colOffset){$columns.first().addClass('offset-lg-'+colOffset);}},_setActive:function(){this._super.apply(this,arguments);this.$el.find('[data-select-count]').removeClass('active').filter('[data-select-count='+this.$target.children().length+']').addClass('active');},});options.registry.parallax=options.Class.extend({start:function(){var self=this;this.$target.on('snippet-option-change snippet-option-preview',function(){self._refreshPublicWidgets();});return this._super.apply(this,arguments);},onFocus:function(){this.trigger_up('option_update',{optionNames:['background','background_position'],name:'target',data:this.$target.find('> .s_parallax_bg'),});this._refreshPublicWidgets();},onMove:function(){this._refreshPublicWidgets();},scroll:function(previewMode,value){this.$target.attr('data-scroll-background-ratio',value);this._refreshPublicWidgets();},_setActive:function(){this._super.apply(this,arguments);this.$el.find('[data-scroll]').removeClass('active').filter('[data-scroll="'+(this.$target.attr('data-scroll-background-ratio')||0)+'"]').addClass('active');},});var FacebookPageDialog=weWidgets.Dialog.extend({xmlDependencies:weWidgets.Dialog.prototype.xmlDependencies.concat(['/website/static/src/xml/website.facebook_page.xml']),template:'website.facebook_page_dialog',events:_.extend({},weWidgets.Dialog.prototype.events||{},{'change':'_onOptionChange',}),init:function(parent,fbData,options){this._super(parent,_.extend({title:_t("Facebook Page"),},options||{}));this.fbData=$.extend(true,{},fbData);this.final_data=this.fbData;},start:function(){this.$previewPage=this.$('.o_facebook_page');this.opened().then(this._renderPreview.bind(this));return this._super.apply(this,arguments);},_renderPreview:function(){var self=this;var match=this.fbData.href.match(/^(?:https?:\/\/)?(?:www\.)?(?:fb|facebook)\.com\/(?:([\w.]+)|[^/?#]+-([0-9]{15,16}))(?:$|[\/?# ])/);if(match){$.ajax({url:'https://graph.facebook.com/'+(match[2]||match[1])+'/picture',statusCode:{200:function(){self._toggleWarning(true);if(self.fbData.tabs){self.fbData.height=self.fbData.tabs==='events'?300:500;}else if(self.fbData.small_header){self.fbData.height=self.fbData.show_facepile?165:70;}else if(!self.fbData.small_header){self.fbData.height=self.fbData.show_facepile?225:150;}
options.registry.facebookPage.prototype.markFbElement(self.getParent(),self.$previewPage,self.fbData);},404:function(){self._toggleWarning(false);},},});}else{this._toggleWarning(false);}},_toggleWarning:function(toggle){this.trigger_up('widgets_stop_request',{$target:this.$previewPage,});this.$('.facebook_page_warning').toggleClass('d-none',toggle);this.$footer.find('.btn-primary').prop('disabled',!toggle);},_onOptionChange:function(){var self=this;this.fbData.tabs=_.map(this.$('.o_facebook_tabs input:checked'),function(tab){return tab.name;}).join(',');this.fbData.href=this.$('.o_facebook_page_url').val();_.each(this.$('.o_facebook_options input'),function(el){self.fbData[el.name]=$(el).prop('checked');});this._renderPreview();},});options.registry.facebookPage=options.Class.extend({willStart:function(){var defs=[this._super.apply(this,arguments)];var defaults={href:false,height:215,width:350,tabs:'',small_header:false,hide_cover:false,show_facepile:false,};this.fbData=_.defaults(_.pick(this.$target.data(),_.keys(defaults)),defaults);if(!this.fbData.href){var self=this;defs.push(this._rpc({model:'website',method:'search_read',args:[[],['social_facebook']],limit:1,}).then(function(res){if(res){self.fbData.href=res[0].social_facebook||'https://www.facebook.com/Odoo';}}));}
return Promise.all(defs);},start:function(){var self=this;this.$target.on('click.facebook_page_option','.o_add_facebook_page',function(ev){ev.preventDefault();self.fbPageOptions();});return this._super.apply(this,arguments);},destroy:function(){this._super.apply(this,arguments);this.$target.off('.facebook_page_option');},fbPageOptions:function(){var dialog=new FacebookPageDialog(this,this.fbData).open();dialog.on('save',this,function(fbData){this.$target.empty();this.fbData=fbData;options.registry.facebookPage.prototype.markFbElement(this,this.$target,this.fbData);});},markFbElement:function(self,$el,fbData){_.each(fbData,function(value,key){$el.attr('data-'+key,value);$el.data(key,value);});self._refreshPublicWidgets($el);},});options.registry.ul=options.Class.extend({start:function(){var self=this;this.$target.on('mouseup','.o_ul_toggle_self, .o_ul_toggle_next',function(){self.trigger_up('cover_update');});return this._super.apply(this,arguments);},cleanForSave:function(){this._super();if(!this.$target.hasClass('o_ul_folded')){this.$target.find('.o_close').removeClass('o_close');this.$target.find('li').css('list-style','');}},toggleClass:function(){this._super.apply(this,arguments);this.trigger_up('widgets_stop_request',{$target:this.$target,});this.$target.find('.o_ul_toggle_self, .o_ul_toggle_next').remove();this.$target.find('li:has(>ul,>ol)').map(function(){var texts=_.filter(_.toArray(this.childNodes),function(a){return a.nodeType===3;});if(!texts.length||!texts.reduce(function(a,b){return a.textContent+b.textContent;}).match(/\S/)){return;}
$(this).children('ul,ol').addClass('o_close');return $(this).children(':not(ul,ol)')[0]||this;}).prepend('<a href="#" class="o_ul_toggle_self fa" />');var $li=this.$target.find('li:has(+li:not(>.o_ul_toggle_self)>ul, +li:not(>.o_ul_toggle_self)>ol)');$li.css('list-style',this.$target.hasClass('o_ul_folded')?'none':'');$li.map(function(){return $(this).children()[0]||this;}).prepend('<a href="#" class="o_ul_toggle_next fa" />');$li.removeClass('o_open').next().addClass('o_close');this.$target.find('li').removeClass('o_open');this._refreshPublicWidgets();},});options.registry.collapse=options.Class.extend({start:function(){var self=this;this.$target.on('shown.bs.collapse hidden.bs.collapse','[role="tabpanel"]',function(){self.trigger_up('cover_update');});return this._super.apply(this,arguments);},onBuilt:function(){this._createIDs();},onClone:function(){this.$target.find('[data-toggle="collapse"]').removeAttr('data-target').removeData('target');this.$target.find('.collapse').removeAttr('id');this._createIDs();},onMove:function(){this._createIDs();var $panel=this.$target.find('.collapse').removeData('bs.collapse');if($panel.attr('aria-expanded')==='true'){$panel.closest('.accordion').find('.collapse[aria-expanded="true"]').filter(function(){return this!==$panel[0];}).collapse('hide').one('hidden.bs.collapse',function(){$panel.trigger('shown.bs.collapse');});}},_createIDs:function(){var time=new Date().getTime();var $tab=this.$target.find('[data-toggle="collapse"]');var $tablist=this.$target.closest('.accordion');var tablist_id=$tablist.attr('id');if(!tablist_id){tablist_id='myCollapse'+time;$tablist.attr('id',tablist_id);}
$tab.attr('data-parent','#'+tablist_id);$tab.data('parent','#'+tablist_id);var $panel=this.$target.find('.collapse');var panel_id=$panel.attr('id');if(!panel_id){while($('#'+(panel_id='myCollapseTab'+time)).length){time++;}
$panel.attr('id',panel_id);}
$tab.attr('data-target','#'+panel_id);$tab.data('target','#'+panel_id);},});options.registry.gallery=options.Class.extend({xmlDependencies:['/website/static/src/xml/website.gallery.xml'],start:function(){var self=this;this.$target.addClass('o_fake_not_editable').attr('contentEditable',false);this.$target.on('save','img',function(ev){var $img=$(ev.currentTarget);var index=self.$target.find('.carousel-item.active').index();self.$('.carousel:first li[data-target]:eq('+index+')').css('background-image','url('+$img.attr('src')+')');});this.$target.on('click','.o_add_images',function(e){e.stopImmediatePropagation();self.addImages(false);});this.$target.on('dropped','img',function(ev){self.mode(null,self.getMode());if(!ev.target.height){$(ev.target).one('load',function(){setTimeout(function(){self.trigger_up('cover_update');});});}});if(this.$('.container:first > *:not(div)').length){self.mode(null,self.getMode());}
return this._super.apply(this,arguments);},onBuilt:function(){var uuid=new Date().getTime();this.$target.find('.carousel').attr('id','slideshow_'+uuid);this.$target.find('[data-target]').attr('data-target','#slideshow_'+uuid);},cleanForSave:function(){if(this.$target.hasClass('slideshow')){this.$target.removeAttr('style');}},addImages:function(previewMode){var self=this;var $container=this.$('.container:first');var dialog=new weWidgets.MediaDialog(this,{multiImages:true,onlyImages:true,mediaWidth:1920});var lastImage=_.last(this._getImages());var index=lastImage?this._getIndex(lastImage):-1;dialog.on('save',this,function(attachments){for(var i=0;i<attachments.length;i++){$('<img/>',{class:'img img-fluid',src:attachments[i].image_src,'data-index':++index,}).appendTo($container);}
self._reset();self.trigger_up('cover_update');this._setActive();});dialog.open();},columns:function(previewMode,value){this.$target.attr('data-columns',value);var $activeMode=this.$el.find('.active[data-mode]');this.mode(null,$activeMode.data('mode'),$activeMode);},getMode:function(){var mode='slideshow';if(this.$target.hasClass('o_masonry')){mode='masonry';}
if(this.$target.hasClass('o_grid')){mode='grid';}
if(this.$target.hasClass('o_nomode')){mode='nomode';}
return mode;},grid:function(){var imgs=this._getImages();var $row=$('<div/>',{class:'row'});var columns=this._getColumns();var colClass='col-lg-'+(12/columns);var $container=this._replaceContent($row);_.each(imgs,function(img,index){var $img=$(img);var $col=$('<div/>',{class:colClass});$col.append($img).appendTo($row);if((index+1)%columns===0){$row=$('<div/>',{class:'row'});$row.appendTo($container);}});this.$target.css('height','');},interval:function(previewMode,value){this.$target.find('.carousel:first').attr('data-interval',value);},masonry:function(){var self=this;var imgs=this._getImages();var columns=this._getColumns();var colClass='col-lg-'+(12/columns);var cols=[];var $row=$('<div/>',{class:'row'});this._replaceContent($row);for(var c=0;c<columns;c++){var $col=$('<div/>',{class:'col o_snippet_not_selectable '+colClass});$row.append($col);cols.push($col[0]);}
while(imgs.length){var min=Infinity;var $lowest;_.each(cols,function(col){var $col=$(col);var height=$col.is(':empty')?0:$col.find('img').last().offset().top+$col.find('img').last().height()-self.$target.offset().top;if(height<min){min=height;$lowest=$col;}});$lowest.append(imgs.pop());}},mode:function(previewMode,value,$opt){this.$target.css('height','');this[value]();this.$target.removeClass('o_nomode o_masonry o_grid o_slideshow').addClass('o_'+value);this.trigger_up('cover_update');},nomode:function(){var $row=$('<div/>',{class:'row'});var imgs=this._getImages();this._replaceContent($row);_.each(imgs,function(img){var wrapClass='col-lg-3';if(img.width>=img.height*2||img.width>600){wrapClass='col-lg-6';}
var $wrap=$('<div/>',{class:wrapClass}).append(img);$row.append($wrap);});},removeAllImages:function(previewMode){var $addImg=$('<div>',{class:'alert alert-info css_editable_mode_display text-center',});var $text=$('<span>',{class:'o_add_images',style:'cursor: pointer;',text:_t(" Add Images"),});var $icon=$('<i>',{class:' fa fa-plus-circle',});this._replaceContent($addImg.append($icon).append($text));},slideshow:function(){var imgStyle=this.$el.find('.active[data-styling]').data('styling')||'';var urls=_.map(this._getImages(),function(img){return $(img).attr('src');});var currentInterval=this.$target.find('.carousel:first').attr('data-interval');var params={srcs:urls,index:0,title:"",interval:currentInterval||this.$target.data('interval')||0,id:'slideshow_'+new Date().getTime(),userStyle:imgStyle,},$slideshow=$(qweb.render('website.gallery.slideshow',params));this._replaceContent($slideshow);_.each(this.$('img'),function(img,index){$(img).attr({contenteditable:true,'data-index':index});});this.$target.css('height',Math.round(window.innerHeight*0.7));this.$target.off('slide.bs.carousel').off('slid.bs.carousel');this.$('li.fa').off('click');this._refreshPublicWidgets();},styling:function(previewMode,value){var classes=_.map(this.$el.find('[data-styling]'),function(el){return $(el).data('styling');}).join(' ');this.$('img').removeClass(classes).addClass(value);},notify:function(name,data){this._super.apply(this,arguments);if(name==='image_removed'){data.$image.remove();this._reset();}else if(name==='image_index_request'){var imgs=this._getImages();var position=_.indexOf(imgs,data.$image[0]);imgs.splice(position,1);switch(data.position){case'first':imgs.unshift(data.$image[0]);break;case'prev':imgs.splice(position-1,0,data.$image[0]);break;case'next':imgs.splice(position+1,0,data.$image[0]);break;case'last':imgs.push(data.$image[0]);break;}
_.each(imgs,function(img,index){$(img).attr('data-index',index);});this._reset();}},_getImages:function(){var imgs=this.$('img').get();var self=this;imgs.sort(function(a,b){return self._getIndex(a)-self._getIndex(b);});return imgs;},_getIndex:function(img){return img.dataset.index||0;},_getColumns:function(){return parseInt(this.$target.attr('data-columns'))||3;},_replaceContent:function($content){var $container=this.$('.container:first');$container.empty().append($content);return $container;},_setActive:function(){this._super(...arguments);var activeModeSelectors=[];for(const className of this.$target[0].classList){if(className.startsWith('o_')){activeModeSelectors.push('[data-mode="'+className.substring(2)+'"]');}}
var activeMode=this.$el.find('[data-mode]').removeClass('active').filter(activeModeSelectors.join(', ')).addClass('active').data('mode');var carousel=this.$target[0].querySelector('.carousel');var activeInterval=carousel?(carousel.dataset.interval||0):undefined;var $intervalOptions=this.$el.find('[data-interval]');$intervalOptions.removeClass('active').filter('[data-interval="'+activeInterval+'"]').addClass('active');$intervalOptions.closest('we-collapse-area')[0].classList.toggle('d-none',activeMode!=='slideshow');var columns=this._getColumns();var $columnOptions=this.$el.find('[data-columns]');$columnOptions.removeClass('active').filter('[data-columns="'+columns+'"]').addClass('active');$columnOptions.closest('we-collapse-area')[0].classList.toggle('d-none',!(activeMode==='grid'||activeMode==='masonry'));this.el.querySelector('.o_w_image_spacing_option').classList.toggle('d-none',activeMode==='slideshow');var $stylingOptions=this.$el.find('[data-styling]');$stylingOptions.removeClass('active');var img=this.$target[0].querySelector('img');var activeStyleSelectors=[];if(img){for(const className of img.classList){activeStyleSelectors.push('[data-styling="'+className+'"]');}}
var $toEnable=activeStyleSelectors.length?$stylingOptions.filter(activeStyleSelectors.join(', ')):null;if(!$toEnable||!$toEnable.length){$toEnable=$stylingOptions.first();}
$toEnable.addClass('active');},});options.registry.gallery_img=options.Class.extend({onRemove:function(){this.trigger_up('option_update',{optionName:'gallery',name:'image_removed',data:{$image:this.$target,},});},position:function(previewMode,value){this.trigger_up('deactivate_snippet');this.trigger_up('option_update',{optionName:'gallery',name:'image_index_request',data:{$image:this.$target,position:value,},});},});options.registry.topMenuTransparency=options.Class.extend({transparent:function(previewMode,value,$opt){var self=this;this.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_overlay'}],onSuccess:function(){self.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_color',value:''}],});},});},_setActive:function(){this._super.apply(this,arguments);this.trigger_up('action_demand',{actionName:'get_page_option',params:['header_overlay'],onSuccess:value=>{this.$el.find('[data-transparent]').toggleClass('active',!!value);},});},});options.registry.topMenuColor=options.registry.colorpicker.extend({start:function(){var self=this;var def=this._super.apply(this,arguments);this.$target.on('snippet-option-change',function(){self.onFocus();});return def;},onFocus:function(){this.trigger_up('action_demand',{actionName:'get_page_option',params:['header_overlay'],onSuccess:value=>{this.$el.toggleClass('d-none',!value);},});},_onColorButtonClick:function(){this._super.apply(this,arguments);var bgs=this.$target.attr('class').match(/bg-(\w|-)+/g);var allowedBgs=this.classes.split(' ');var color=_.intersection(bgs,allowedBgs).join(' ');this.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_color',value:color}],});},});options.registry.anchorName=options.Class.extend({xmlDependencies:['/website/static/src/xml/website.editor.xml'],onClone:function(){this.$target.removeAttr('id data-anchor');},openAnchorDialog:function(previewMode,value,$opt){var self=this;var buttons=[{text:_t("Save"),classes:'btn-primary',click:function(){var $input=this.$('.o_input_anchor_name');var anchorName=$input.val().trim().replace(/\s/g,'_');if(self.$target[0].id===anchorName){this.close();return;}
var isValid=/^[\w-]+$/.test(anchorName);var alreadyExists=isValid&&$('#'+anchorName).length>0;var anchorOK=isValid&&!alreadyExists;this.$('.o_anchor_not_valid').toggleClass('d-none',isValid);this.$('.o_anchor_already_exists').toggleClass('d-none',!alreadyExists);$input.toggleClass('is-invalid',!anchorOK);if(anchorOK){self._setAnchorName(anchorName);this.close();}},},{text:_t("Discard"),close:true,}];if(this.$target.attr('id')){buttons.push({text:_t("Remove"),classes:'btn-link ml-auto',icon:'fa-trash',close:true,click:function(){self._setAnchorName();},});}
new Dialog(this,{title:_t("Link Anchor"),$content:$(qweb.render('website.dialog.anchorName',{currentAnchor:this.$target.attr('id'),})),buttons:buttons,}).open();},_setAnchorName:function(value){if(value){this.$target.attr({'id':value,'data-anchor':true,});}else{this.$target.removeAttr('id data-anchor');}
this.$target.trigger('content_changed');},});options.registry.CoverProperties=options.Class.extend({init:function(){this._super.apply(this,arguments);this.$image=this.$target.find('.o_record_cover_image');this.$filter=this.$target.find('.o_record_cover_filter');},start:function(){this.$filterValueOpts=this.$el.find('[data-filter-value]');this.$filterColorOpts=this.$el.find('[data-filter-color]');this.filterColorClasses=this.$filterColorOpts.map(function(){return $(this).data('filterColor');}).get().join(' ');return this._super.apply(this,arguments);},clear:function(previewMode,value,$opt){this.selectClass(previewMode,'',$());this.$image.css('background-image','');},change:function(previewMode,value,$opt){var $image=$('<img/>');var background=this.$image.css('background-image');if(background&&background!=='none'){$image.attr('src',background.match(/^url\(["']?(.+?)["']?\)$/)[1]);}
var editor=new weWidgets.MediaDialog(this,{mediaWidth:1920,onlyImages:true,firstFilters:['background']},$image[0]).open();editor.on('save',this,function(image){var src=image.src;this.$image.css('background-image',src?('url('+src+')'):'');if(!this.$target.hasClass('o_record_has_cover')){var $opt=this.$el.find('.o_record_cover_opt_size_default[data-select-class]');this.selectClass(previewMode,$opt.data('selectClass'),$opt);}
this._setActive();});},filterValue:function(previewMode,value,$opt){this.$filter.css('opacity',value);},filterColor:function(previewMode,value,$opt){this.$filter.removeClass(this.filterColorClasses);if(value){this.$filter.addClass(value);}
var $firstVisibleFilterOpt=this.$filterValueOpts.eq(1);if(parseFloat(this.$filter.css('opacity'))<parseFloat($firstVisibleFilterOpt.data('filterValue'))){this.filterValue(previewMode,$firstVisibleFilterOpt.data('filterValue'),$firstVisibleFilterOpt);}},_setActive:function(){this._super.apply(this,arguments);_.each(this.$el.children(),el=>{var $el=$(el);if(!$el.is('[data-change]')){$el.removeClass('d-none');['size','filters','text_size','text_align'].forEach(optName=>{var $opts=$el.find('[data-cover-opt="'+optName+'"]');var notAllowed=(this.$target.data('use_'+optName)!=='True');if($opts.length&&(!this.$target.hasClass('o_record_has_cover')||notAllowed)){$el.addClass('d-none');}});}});this.$el.find('[data-clear]').toggleClass('d-none',!this.$target.hasClass('o_record_has_cover'));this.$filterValueOpts.removeClass('active');this.$filterColorOpts.removeClass('active');var activeFilterValue=this.$filterValueOpts.filter((i,el)=>{return(parseFloat($(el).data('filterValue')).toFixed(1)===parseFloat(this.$filter.css('opacity')).toFixed(1));}).addClass('active').data('filterValue');var activeFilterColor=this.$filterColorOpts.filter((i,el)=>{return this.$filter.hasClass($(el).data('filterColor'));}).addClass('active').data('filterColor');this.$target[0].dataset.coverClass=this.$el.find('.active[data-cover-opt="size"]').data('selectClass')||'';this.$target[0].dataset.textSizeClass=this.$el.find('.active[data-cover-opt="text_size"]').data('selectClass')||'';this.$target[0].dataset.textAlignClass=this.$el.find('.active[data-cover-opt="text_align"]').data('selectClass')||'';this.$target[0].dataset.filterValue=activeFilterValue||0.0;this.$target[0].dataset.filterColor=activeFilterColor||'';},});});;

/* /website/static/src/js/editor/wysiwyg_multizone.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('web_editor.wysiwyg.multizone',function(require){'use strict';var Wysiwyg=require('web_editor.wysiwyg');var snippetsEditor=require('web_editor.snippet.editor');function toggleDropdown($toggles,show){return Promise.all(_.map($toggles,toggle=>{var $toggle=$(toggle);var $dropdown=$toggle.parent();var shown=$dropdown.hasClass('show');if(shown===show){return;}
var toShow=!shown;return new Promise(resolve=>{$dropdown.one(toShow?'shown.bs.dropdown':'hidden.bs.dropdown',()=>resolve());$toggle.dropdown(toShow?'show':'hide');});})).then(()=>$toggles);}
var WysiwygMultizone=Wysiwyg.extend({start:function(){var self=this;this.options.toolbarHandler=$('#web_editor-top-edit');this.options.saveElement=function($el,context,withLang){var outerHTML=this._getEscapedElement($el).prop('outerHTML');return self._saveElement(outerHTML,self.options.recordInfo,$el[0]);};var $megaMenuToggles=this.$('.o_mega_menu_toggle');$megaMenuToggles.removeAttr('data-toggle').dropdown('dispose');$megaMenuToggles.on('click.wysiwyg_multizone',ev=>{var $toggle=$(ev.currentTarget);var dispose=($els=>$els.dropdown('dispose'));toggleDropdown($megaMenuToggles.not($toggle),false).then(dispose);toggleDropdown($toggle).then(dispose).then($el=>{var isShown=$el.parent().hasClass('show');this.editor.snippetsMenu.toggleMegaMenuSnippets(isShown);});});_.each(this.$('.oe_structure[data-editor-message!="False"]'),el=>{var isBlank=!el.innerHTML.trim();if(isBlank){el.innerHTML='';}
el.classList.toggle('oe_empty',isBlank);});return this._super.apply(this,arguments).then(()=>{if(this.$('.o_mega_menu').hasClass('show')){this.editor.snippetsMenu.toggleMegaMenuSnippets(true);}});},save:function(){if(this.isDirty()){return this._restoreMegaMenus().then(()=>this.editor.save(false)).then(()=>({isDirty:true}));}else{return{isDirty:false};}},destroy:function(){this._restoreMegaMenus();this._super.apply(this,arguments);},_getEditableArea:function(){return $(':o_editable');},_saveCoverProperties:function(editable){var el=editable.closest('.o_record_cover_container');if(!el){return;}
var resModel=el.dataset.resModel;var resID=parseInt(el.dataset.resId);if(!resModel||!resID){throw new Error('There should be a model and id associated to the cover');}
this.__savedCovers=this.__savedCovers||{};this.__savedCovers[resModel]=this.__savedCovers[resModel]||[];if(this.__savedCovers[resModel].includes(resID)){return;}
this.__savedCovers[resModel].push(resID);var cssBgImage=$(el.querySelector('.o_record_cover_image')).css('background-image');var coverProps={'background-image':cssBgImage.replace(/"/g,'').replace(window.location.protocol+"//"+window.location.host,''),'background-color':el.dataset.filterColor,'opacity':el.dataset.filterValue,'resize_class':el.dataset.coverClass,'text_size_class':el.dataset.textSizeClass,'text_align_class':el.dataset.textAlignClass,};return this._rpc({model:resModel,method:'write',args:[resID,{'cover_properties':JSON.stringify(coverProps)}],});},_saveElement:function(outerHTML,recordInfo,editable){var promises=[];var $el=$(editable);var viewID=$el.data('oe-id');if(viewID){promises.push(this._rpc({model:'ir.ui.view',method:'save',args:[viewID,outerHTML,$el.data('oe-xpath')||null,],context:recordInfo.context,}));}
if($el.data('oe-field')==='mega_menu_content'){var classes=_.without($el.attr('class').split(' '),'dropdown-menu','o_mega_menu','show');promises.push(this._rpc({model:'website.menu',method:'write',args:[[parseInt($el.data('oe-id'))],{'mega_menu_classes':classes.join(' '),},],}));}
var prom=this._saveCoverProperties(editable);if(prom){promises.push(prom);}
return Promise.all(promises);},_restoreMegaMenus:function(){var $megaMenuToggles=this.$('.o_mega_menu_toggle');$megaMenuToggles.off('.wysiwyg_multizone').attr('data-toggle','dropdown').dropdown({});return toggleDropdown($megaMenuToggles,false);},});snippetsEditor.Class.include({toggleMegaMenuSnippets:function(show){setTimeout(()=>this._activateSnippet(false));this.$('#snippet_mega_menu').toggleClass('d-none',!show);},_insertDropzone:function($hook){var $hookParent=$hook.parent();var $dropzone=this._super(...arguments);$dropzone.attr('data-editor-message',$hookParent.attr('data-editor-message'));$dropzone.attr('data-editor-sub-message',$hookParent.attr('data-editor-sub-message'));return $dropzone;},});return WysiwygMultizone;});;

/* /website/static/src/js/editor/wysiwyg_multizone_translate.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('web_editor.wysiwyg.multizone.translate',function(require){'use strict';var core=require('web.core');var webDialog=require('web.Dialog');var WysiwygMultizone=require('web_editor.wysiwyg.multizone');var rte=require('web_editor.rte');var Dialog=require('wysiwyg.widgets.Dialog');var websiteNavbarData=require('website.navbar');var _t=core._t;var RTETranslatorWidget=rte.Class.extend({_saveElement:function($el,context,withLang){var self=this;if($el.data('oe-translation-id')){return this._rpc({model:'ir.translation',method:'save_html',args:[[+$el.data('oe-translation-id')],this._getEscapedElement($el).html()],context:context,}).catch(function(error){Dialog.alert(null,error.data.message);});}
return this._super($el,context,withLang===undefined?true:withLang);},});var AttributeTranslateDialog=Dialog.extend({init:function(parent,options,node){this._super(parent,_.extend({title:_t("Translate Attribute"),buttons:[{text:_t("Close"),classes:'btn-primary',click:this.save}],},options||{}));this.translation=$(node).data('translation');},start:function(){var $group=$('<div/>',{class:'form-group'}).appendTo(this.$el);_.each(this.translation,function(node,attr){var $node=$(node);var $label=$('<label class="col-form-label"></label>').text(attr);var $input=$('<input class="form-control"/>').val($node.html());$input.on('change keyup',function(){var value=$input.val();$node.html(value).trigger('change',node);$node.data('$node').attr($node.data('attribute'),value).trigger('translate');$node.trigger('change');});$group.append($label).append($input);});return this._super.apply(this,arguments);}});var WysiwygTranslate=WysiwygMultizone.extend({custom_events:_.extend({},WysiwygMultizone.prototype.custom_events||{},{ready_to_save:'_onSave',}),init:function(parent,options){this.lang=options.lang;options.recordInfo=_.defaults({context:{lang:this.lang}},options.recordInfo,options);this._super.apply(this,arguments);},start:function(){var self=this;this.editor=new(this.Editor)(this,Object.assign({Editor:RTETranslatorWidget},this.options));this.$editor=this.editor.rte.editable();var promise=this.editor.prependTo(this.$editor[0].ownerDocument.body);return promise.then(function(){self._relocateEditorBar();var attrs=['placeholder','title','alt'];_.each(attrs,function(attr){self._getEditableArea().filter('['+attr+'*="data-oe-translation-id="]').filter(':empty, input, select, textarea, img').each(function(){var $node=$(this);var translation=$node.data('translation')||{};var trans=$node.attr(attr);var match=trans.match(/<span [^>]*data-oe-translation-id="([0-9]+)"[^>]*>(.*)<\/span>/);var $trans=$(trans).addClass('d-none o_editable o_editable_translatable_attribute').appendTo('body');$trans.data('$node',$node).data('attribute',attr);translation[attr]=$trans[0];$node.attr(attr,match[2]);var select2=$node.data('select2');if(select2){select2.blur();$node.on('translate',function(){select2.blur();});$node=select2.container.find('input');}
$node.addClass('o_translatable_attribute').data('translation',translation);});});self.translations=[];self.$editables_attr=self._getEditableArea().filter('.o_translatable_attribute');self.$editables_attribute=$('.o_editable_translatable_attribute');self.$editables_attribute.on('change',self._onChange.bind(self));self._markTranslatableNodes();});},isDirty:function(){return this._super()||this.$editables_attribute.hasClass('o_dirty');},_getEditableArea:function(){var $editables=this._super();return $editables.add(this.$editables_attribute);},_getRecordInfo:function(options){options=options||{};var recordInfo=this._super(options);var $editable=$(options.target).closest(this._getEditableArea());if(!$editable.length){$editable=$(this._getFocusedEditable());}
recordInfo.context.lang=this.lang;recordInfo.translation_id=$editable.data('oe-translation-id')|0;return recordInfo;},_editorOptions:function(){var options=this._super();options.toolbar=[['font',['bold','italic','underline','clear']],['fontsize',['fontsize']],['color',['color']],['history',['undo','redo']],];return options;},_onChange:function(ev){var $node=$(ev&&ev.target||this._getFocusedEditable());if(!$node.length){return;}
$node.find('p').each(function(){var $p=$(this);$p.after($p.html()).remove();});var trans=this._getTranlationObject($node[0]);$node.toggleClass('o_dirty',trans.value!==$node.html().replace(/[ \t\n\r]+/,' '));},_getTranlationObject:function(node){var $node=$(node);var id=+$node.data('oe-translation-id');if(!id){id=$node.data('oe-model')+','+$node.data('oe-id')+','+$node.data('oe-field');}
var trans=_.find(this.translations,function(trans){return trans.id===id;});if(!trans){this.translations.push(trans={'id':id});}
return trans;},_markTranslatableNodes:function(){var self=this;this._getEditableArea().each(function(){var $node=$(this);var trans=self._getTranlationObject(this);trans.value=(trans.value?trans.value:$node.html()).replace(/[ \t\n\r]+/,' ');});this._getEditableArea().prependEvent('click.translator',function(ev){if(ev.ctrlKey||!$(ev.target).is(':o_editable')){return;}
ev.preventDefault();ev.stopPropagation();});this.$editables_attr.each(function(){var $node=$(this);var translation=$node.data('translation');_.each(translation,function(node,attr){var trans=self._getTranlationObject(node);trans.value=(trans.value?trans.value:$node.html()).replace(/[ \t\n\r]+/,' ');$node.attr('data-oe-translation-state',(trans.state||'to_translate'));});});this.$editables_attr.prependEvent('mousedown.translator click.translator mouseup.translator',function(ev){if(ev.ctrlKey){return;}
ev.preventDefault();ev.stopPropagation();if(ev.type!=='mousedown'){return;}
new AttributeTranslateDialog(self,{},ev.target).open();});},_onSave:function(ev){ev.stopPropagation();},});return WysiwygTranslate;});;

/* /website/static/src/js/editor/widget_link.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.editor.link',function(require){'use strict';var weWidgets=require('wysiwyg.widgets');var wUtils=require('website.utils');weWidgets.LinkDialog.include({xmlDependencies:(weWidgets.LinkDialog.prototype.xmlDependencies||[]).concat(['/website/static/src/xml/website.editor.xml']),events:_.extend({},weWidgets.LinkDialog.prototype.events||{},{'change select[name="link_anchor"]':'_onAnchorChange','input input[name="url"]':'_onURLInput',}),custom_events:_.extend({},weWidgets.LinkDialog.prototype.custom_events||{},{website_url_chosen:'_onAutocompleteClose',}),start:function(){var def=this._super.apply(this,arguments);wUtils.autocompleteWithPages(this,this.$('input[name="url"]'));this.opened(this._adaptPageAnchor.bind(this));return def;},_adaptPageAnchor:function(){var urlInputValue=this.$('input[name="url"]').val();var $pageAnchor=this.$('.o_link_dialog_page_anchor');var isFromWebsite=urlInputValue[0]==='/';var $selectMenu=this.$('select[name="link_anchor"]');var $anchorsLoading=this.$('.o_anchors_loading');$anchorsLoading.removeClass('d-none');$pageAnchor.toggleClass('d-none',!isFromWebsite);$selectMenu.empty();wUtils.loadAnchors(urlInputValue).then(function(anchors){_.each(anchors,function(anchor){$selectMenu.append($('<option>',{text:anchor}));});always();}).guardedCatch(always);function always(){$anchorsLoading.addClass('d-none');$selectMenu.prop("selectedIndex",-1);}},_onAutocompleteClose:function(){this._onURLInput();},_onAnchorChange:function(){var anchorValue=this.$('[name="link_anchor"]').val();var $urlInput=this.$('[name="url"]');var urlInputValue=$urlInput.val();if(urlInputValue.indexOf('#')>-1){urlInputValue=urlInputValue.substr(0,urlInputValue.indexOf('#'));}
$urlInput.val(urlInputValue+anchorValue);},_onURLInput:function(){this._super.apply(this,arguments);this._adaptPageAnchor();},});});